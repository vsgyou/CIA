# 소개 
Contrastive Counterfactual Learning for Causality-aware Interpretable Recommender System 논문을 구현하고 공부하기 위한 저장소입니다.

# 일정
| 날짜 | 내용 | 
| -------- | -------- |
| 2025/03/25 | 논문 구현 | 
| 2025/04/01 | 논문 구현 및 분석 | 
| 2025/04/08 | 샘플링 방법 탐구, 추가 데이터로 실험 | 
| 2025/04/15 | 결정된 샘플링 방법 적용 후 성능 평가, 시각화로 결과 입증 | 
| 2025/04/22 | |
| 2025/04/29 | | 
| 2025/05/06 | |
| 2025/05/13 | | 
| 2025/05/20 | |
---

### 진행 현황(2025.04.01)
  ### 사용 데이터
  - **coat 데이터**
      - **Train 데이터**: 유저 290명, 아이템 300개, 6960개의 상호작용 데이터
      - **Test 데이터**: 유저 290명, 아이템 300개, 4640개의 상호작용 데이터
- #### 코드 구현
  논문에서 제안한 방식 구현 (Counterfactual sampling)
  
  **CCL 손실함수(Lambda) 값에 따른 성능 비교**
  | Metric / Lambda | ndcg@5(↑) | ndcg@10(↑) | Gini Index(↓) | Test MSE(↓) |
  | --- | --- | --- | --- | --- |
  | 0.5 | 0.6095 | 0.6847 | 0.3483 | 0.2665 |
  | 0.7 | 0.6417 | 0.7063 | 0.3254 | 0.2689 |
  | 1   | 0.6223 | 0.6958 | 0.3345 | 0.2685 |
  | 1.3 | 0.6077 | 0.6778 | 0.347  | 0.2662 |
  | 1.5 | 0.6102 | 0.6870 | 0.3310 | 0.2665 |

- ##### 문제점
  1. 논문에서 제안한 방식의 성능이 간단한 MF 모델보다 낮음.
  2. 인기도 기반 샘플링 방법은 아이템 별로 인기도를 계산해 차이가 가장 큰 아이템을 샘플로 사용 → 대부분 동일한 아이템을 추출하는 문제 발생.

- #### 이를 대체하기 위한 간단한 실험 방법
  아이템마다 인기도 차이를 계산한 값을 확률로 사용하여 샘플링 진행.

  | Metrics        | 기존 CCL | 개선된 CCL |
  | ---            | ---      | ---        |
  | Test MSE       | 0.2722   | 0.2711     |
  | Test AUC       | 0.6858   | 0.6859     |
  | NDCG@5         | 0.545    | 0.5800     |
  | NDCG@10        | 0.6290   | 0.6535     |
  | Gini Index     | 0.3682   | 0.3470     |
  | Global Utility | 0.4648   | 0.4840     |
  
---

### 진행현황(2025.04.08)
  ### 실험 진행 
  - ## MF 기반의 적용 결과와 NCF 기반의 적용 결과 비교

    | Metrics        | MF | MF_CF | MF_pop | NCF | NCF_CF | NCF_pop |
    | ---            | ---      | ---      | ---      | ---      | ---      | ---      | 
    | Test MSE       | 0.2649   | 0.2736   | 0.2731   | 0.2576   | 0.2622   | 0.2606   |
    | Test AUC       | 0.7074   | 0.6823   | 0.6817   | 0.7324   | 0.7275   | 0.7338   |
    | NDCG@5         | 0.6045   | 0.5624   | 0.5536   | 0.6158   | 0.5823   | 0.5858   |
    | NDCG@10        | 0.6861   | 0.6394   | 0.6424   | 0.6886   | 0.6670   | 0.6673   |
    | Gini Index     | 0.3234   | 0.3421   | 0.3601   | 0.3680   | 0.3680   | 0.3789   |
    | Global Utility | 0.4924   | 0.4703   | 0.4627   | 0.4012   | 0.4012   | 0.4813   |

    - 전체적으로, NCF 모델을 통한 학습의 결과가 좋은 성능을 보임

  - ## Movielens-100K 데이터로의 실험 추가
      Coat 데이터는 랜덤한 상황을 가정한 test셋을 구성하였지만, 랜덤하지 않은 데이터에서의 결과 확인
      Movielens-100K 데이터는 유저당 10개의 아이템과 상호작용한 test셋으로 구성되어 있음

      | Metrics        | MF      | MF_CF   | MF_pop  | NCF     | NCF_CF  | NCF_pop  |
      |----------------|---------|---------|---------|---------|---------|---------|
      | Test MSE       | 0.1651  | 0.1671  | 0.1672  | 0.1564  | 0.1564  | 0.1571  |
      | Test AUC       | 0.7507  | 0.7268  | 0.7291  | 0.7801  | 0.7801  | 0.7830  |
      | NDCG@3         | 0.9462  | 0.9452  | -       | 0.9536  | 0.9487  | 0.9480  |
      | NDCG@5         | 0.8791  | 0.9367  | 0.9378  | 0.9378  | 0.9351  | 0.9370  |
      | Gini Index     | 0.0761  | 0.0783  | 0.0736  | 0.0765  | 0.0765  | 0.0749  |
      | Global Utility | 0.9066  | 0.9056  | 0.9090  | 0.9051  | 0.9051  | 0.9085  |
---
### 진행현황(2025.04.15)
### 실험 결과 시각화

- 유저의 성향에 따른 추천된 아이템의 인기도 비교

  - 유저가 상호작용한 아이템의 평균 인기도가 가장 높은 20명의 유저(Top 20 User)    
  - 유저가 상호작용한 아이템의 평균 인기도가 가장 낮은 20명의 유저(Low 20 User)
    
- Coat
  
  <img src = "https://github.com/user-attachments/assets/6f3e92ab-7ccd-43ae-ac53-6c5d3d904b10" alt="image" width = "600" />

    - Train 데이터에서 Top 20 User들이 상호작용한 아이템들의 평균 인기도는 0.4995
    - Train 데이터에서 Top 20 User들이 상호작용한 아이템들의 평균 인기도는 0.2290

- Movielens
  
  <img src = "https://github.com/user-attachments/assets/ea71cbc3-6e1f-47d5-93a7-805d82f92028" alt="image" width = "600" />

    - Train 데이터에서 Top 20 User들이 상호작용한 아이템들의 평균 인기도는 0.7119
    - Train 데이터에서 Low 20 User들이 상호작용한 아이템들의 평균 인기도는 0.3564


